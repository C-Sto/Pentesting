#!/bin/bash
echo "==================================="
echo -n "Percent cracked (total): "
echo $(hashcat -m 1000 extracted.enabled.ntds --show --username | wc -l)/$(cat extracted.enabled.ntds | wc -l)\($(echo "scale=3;($(hashcat -m 1000 extracted.enabled.ntds --show --username | wc -l)/$(cat extracted.enabled.ntds | wc -l))*100" | bc -l )%\)
echo "-----------------------------------"
echo -n "Percent cracked (unique):"
echo $(hashcat -m 1000 extracted.enabled.ntds --show | wc -l)/$(cat extracted.enabled.ntds | cut -f 4 -d : | sort -u |  wc -l)\($(echo "scale=3;($(hashcat -m 1000 extracted.enabled.ntds --show | wc -l)/$(cat extracted.enabled.ntds | cut -f 4 -d : | sort -u |  wc -l))*100" | bc -l )%\)
echo "-----------------------------------"
echo "Most re-used passwords and their occurences: "
hashcat -m 1000 extracted.enabled.ntds --show --username | cut -f 3 -d : | sort | uniq -c | sort -n -r | head -n 10 
echo "-----------------------------------"
echo "Non-Unique Passwords: " 
echo $(echo "$(cat extracted.enabled.ntds | cut -f 4 -d : | wc -l)-$(cat extracted.enabled.ntds | cut -f 4 -d : | sort -u | wc -l)" | bc -l )
echo "-----------------------------------"
echo "Accounts with 'admin' in username (likely privileged): " 
hashcat -m 1000 extracted.enabled.ntds --show --username | grep -i -e 'admin.*:' | cut -f 1,3 -d : 
echo "-----------------------------------"
echo "Accounts with 'svc' in username (possibly): " 
hashcat -m 1000 extracted.enabled.ntds --show --username | grep -i -e 'svc.*:' | cut -f 1,3 -d : 
echo "-----------------------------------"
echo "Full list of cracked passwords saved to cracked.txt"
hashcat -m 1000 extracted.enabled.ntds --show --username > cracked.txt
echo "==================================="